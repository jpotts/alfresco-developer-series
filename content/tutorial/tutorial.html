<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <link rel="profile" href="http://gmpg.org/xfn/11" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jeff Potts, Metaversant Group" />
  <title>Working With Custom Content Types in Alfresco | ECM
Architect | Alfresco Developer Tutorials</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../../tutorial-common/style.css" type="text/css" />
</head>
<body class="page page-template page-template-onecolumn-page-php custom-background">
<!--
<div class="github-fork-ribbon-wrapper right">
    <div class="github-fork-ribbon">
            <a href="https://github.com/jpotts/alfresco-developer-series">Fork me on GitHub</a>
    </div>
</div>
-->
<div id="wrapper" class="hfeed">
	<div id="main">
		<div id="container" class="one-column">
			<div id="content" role="main">
				<div id="post" class="post page type-page status-draft hentry">
					<div class="entry-content">
<div id="header">
<h1 class="entry-title">Working With Custom Content Types in Alfresco</h1>
<h2 class="author">Jeff Potts, <a href="http://www.metaversant.com">Metaversant Group</a></h2>
<h3 class="date">April, 2015</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#license">License</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#part-1-implementing-a-custom-content-model">Part 1: Implementing a Custom Content Model</a><ul>
<li><a href="#modeling-basics">Modeling Basics</a><ul>
<li><a href="#types">Types</a></li>
<li><a href="#properties">Properties</a></li>
<li><a href="#property-types">Property Types</a></li>
<li><a href="#constraints">Constraints</a></li>
<li><a href="#associations">Associations</a></li>
<li><a href="#aspects">Aspects</a></li>
<li><a href="#custom-behavior">Custom Behavior</a></li>
<li><a href="#content-modeling-best-practices">Content Modeling Best Practices</a></li>
<li><a href="#out-of-the-box-models">Out-of-the-Box Models</a></li>
</ul></li>
<li><a href="#creating-a-custom-content-model">Creating a Custom Content Model</a><ul>
<li><a href="#setting-up">Setting Up</a></li>
<li><a href="#implementing-and-deploying-the-model">Implementing and Deploying the Model</a></li>
</ul></li>
</ul></li>
<li><a href="#part-2-configuring-alfresco-share">Part 2: Configuring Alfresco Share</a><ul>
<li><a href="#configuring-the-custom-model-in-alfresco-share">Configuring the Custom Model in Alfresco Share</a><ul>
<li><a href="#step-1-create-a-project-for-the-share-tier-amp">Step 1: Create a project for the Share tier AMP</a></li>
<li><a href="#step-2-create-a-custom-share-configuration-file">Step 2: Create a custom Share configuration file</a></li>
<li><a href="#step-3-test-your-changes">Step 3: Test Your Changes</a></li>
</ul></li>
<li><a href="#configuring-forms-for-custom-properties">Configuring Forms for Custom Properties</a><ul>
<li><a href="#configuring-the-form-service-for-a-custom-type">Configuring the form service for a custom type</a></li>
<li><a href="#configuring-the-form-service-for-custom-properties">Configuring the form service for custom properties</a></li>
<li><a href="#configuring-advanced-search-in-alfresco-share">Configuring Advanced Search in Alfresco Share</a></li>
</ul></li>
<li><a href="#localizing-strings-for-custom-content-models">Localizing Strings for Custom Content Models</a></li>
<li><a href="#share-configuration-summary">Share Configuration Summary</a></li>
</ul></li>
<li><a href="#part-3-working-with-content-programmatically">Part 3: Working with Content Programmatically</a><ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#creating-content-with-opencmis">Creating Content with OpenCMIS</a></li>
<li><a href="#creating-associations-with-opencmis">Creating Associations with OpenCMIS</a></li>
<li><a href="#searching-for-content-with-opencmis">Searching for Content with OpenCMIS</a><ul>
<li><a href="#queries-on-aspect-based-properties">Queries on Aspect-based Properties</a></li>
<li><a href="#queries-across-multiple-aspects">Queries Across Multiple Aspects</a></li>
<li><a href="#queries-using-dates">Queries Using Dates</a></li>
<li><a href="#running-the-queries">Running the Queries</a></li>
</ul></li>
<li><a href="#deleting-content-with-opencmis">Deleting Content with OpenCMIS</a></li>
</ul></li>
<li><a href="#other-topics-to-explore-on-your-own">Other Topics to Explore on Your Own</a></li>
<li><a href="#where-to-find-more-information">Where to Find More Information</a></li>
</ul>
</div>
<h1 id="license">License</h1>
<div class="figure">
<img src="./images/cc-by-sa-88x31.png" />
</div>
<p>This work is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/3.0/ or send a letter to Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA.</p>
<h1 id="introduction">Introduction</h1>
<p>Alfresco is a flexible platform for developing content management applications. The first step in the process of designing a custom content management application is creating the content model.</p>
<p>The content model Alfresco provides out-of-the-box is fairly comprehensive. In fact, for basic document management needs, you could probably get by with the out-of-the-box model. Of course, you'd be missing out on a lot of the power and functionality that having a model customized for your business needs provides.</p>
<p>Part 1 of this document discusses how to create your own custom content model, but you won’t want to stop there. What good would a custom content model be if you did nothing exciting with the content? After an example content model is in place, Part 2 shows how to configure Alfresco Share to expose the custom model in the user interface, then Part 3 shows how to use OpenCMIS, a standard Java API, to create, search for, and delete content. You can safely swap the order of Parts 2 and 3 according to your interest.</p>
<p>You should already be familiar with general document management and Alfresco functionality from an end-user perspective. If you want to follow along with Part 3, you should also know how to write basic Java code. See “<a href="#where-to-find-more-information">Where to find more information</a>” at the end of this document for a link to the code samples that accompany this article.</p>
<h1 id="part-1-implementing-a-custom-content-model">Part 1: Implementing a Custom Content Model</h1>
<p>Out-of-the-box, Alfresco gives you folders and content and a few other content types. But you’ll probably want to create your own business-specific types. This section discusses how that works.</p>
<h2 id="modeling-basics">Modeling Basics</h2>
<p>A content model describes the data being stored in the repository. The content model is critical--without it, Alfresco would be little more than a file system. Here is a list of key information the content model provides Alfresco:</p>
<ul>
<li><p>Fundamental data types and how those data types should be persisted to the database. For example, without a content model, Alfresco wouldn't know the difference between a <code>String</code> and a <code>Date</code>.</p></li>
<li><p>Higher order data types like “content” and “folder” as well as custom content types like “Standard Operating Procedure” or “Contract”.</p></li>
<li><p>Out-of-the-box aspects like “auditable” and “classifiable” as well as custom aspects like “rateable” or “commentable”.</p></li>
<li><p>Properties (or metadata) specific to each content type.</p></li>
<li><p>Constraints placed on properties (such as property values that must match a certain pattern or property values that must come from a specific list of possible values).</p></li>
<li><p>How to index content for searching.</p></li>
<li><p>Relationships between content types.</p></li>
</ul>
<p>Alfresco content models are built using a small set of building blocks: Types, Properties, Property types, Constraints, Associations, and Aspects.</p>
<h3 id="types">Types</h3>
<p><em>Types</em> are like types or classes in the object-oriented world. They can be used to model business objects, they have properties, and they can inherit from a parent type. “Content”, “Person”, and “Folder” are three important types defined out-of-the-box. Custom types are limited only by your imagination and business requirements. Examples include things like “Expense Report”, “Medical Record”, “Movie”, “Song”, and “Comment”.</p>
<p>Note that types, properties, constraints, associations, and aspects have names. Names are made unique across the repository by using a namespace specific to the model. The namespace has an abbreviation. Rather than use “Example” or “Foo”, this tutorial assumes Alfresco is being implemented for a fictitious company called SomeCo. So, for example, SomeCo might define a custom model which declares a namespace with the URI of “http://www.someco.com/model/content/1.0” and a prefix of “sc”. Any type defined as part of that model would have a name prefixed with “sc:”. You'll see how models are actually defined using XML shortly, but I wanted to introduce the concept of namespaces and prefixes so you would know what they are when you see them. Using namespaces in this way helps prevent name collisions when content models are shared across repositories. In your project it is definitely important that you use your own namespace.</p>
<h3 id="properties">Properties</h3>
<p><em>Properties</em> are pieces of metadata associated with a particular type. For example, the properties of an Expense Report might include things like “Employee Name”, “Date submitted”, “Project”, “Client”, “Expense Report Number”, “Total amount”, and “Currency”. The Expense Report might also include a “content” property to hold the actual expense report file (maybe it is a PDF or an Excel spreadsheet, for example).</p>
<h3 id="property-types">Property Types</h3>
<p><em>Property types</em> (or data types) describe the fundamental types of data the repository will use to store properties. Examples include things like strings, dates, floats, and booleans. Because these data types literally are fundamental, they are pretty much the same for everyone so they are defined for us out-of-the-box. (If you wanted to change the fact that the Alfresco data-type “text” maps to your own custom class rather than <code>java.lang.String</code>, you could, but let's not get ahead of ourselves).</p>
<h3 id="constraints">Constraints</h3>
<p><em>Constraints</em> can optionally be used to restrict the value that Alfresco will store in a property. There are four types of constraints available: <code>REGEX</code>, <code>LIST</code>, <code>MINMAX</code>, and <code>LENGTH</code>. <code>REGEX</code> is used to make sure that a property value matches a regular expression pattern. <code>LIST</code> is used to define a list of possible values for a property. <code>MINMAX</code> provides a numeric range for a property value. <code>LENGTH</code> sets a restriction on the length of a string.</p>
<p>Constraints can be defined once and reused across a model. For example, out-of-the-box, Alfresco makes available a constraint named <code>cm:filename</code> that defines a regular expression constraint for file names. If a property in a custom type needs to restrict values to those matching the filename pattern, the custom model doesn't have to define the constraint again, it simply refers to the <code>cm:filename</code> constraint.</p>
<h3 id="associations">Associations</h3>
<p><em>Associations</em> define relationships between types. Without associations, models would be full of types with properties that store “pointers” to other pieces of content. Going back to the expense report example, each expense report might be stored as an individual object. In addition to an Expense Report type there could also be an Expense type. Associations tell Alfresco about the relationship between an Expense Report and one or more Expenses.</p>
<p>Associations come in two flavors: Peer Associations and Child Associations. (Note that Alfresco refers to Peer Associations simply as “Associations” but I think that's confusing so I'll refer to them with the “Peer” distinction). Peer Associations are just that—-they define a relationship between two objects but neither is subordinate to the other. Child Associations, on the other hand, are used when the target of the association (or child) should not exist when the source (or parent) goes away. This works like a cascaded delete in a relational database: Delete the parent and the child goes away.</p>
<p>An out-of-the-box association that's easy to relate to is <code>cm:contains</code>. The <code>cm:contains</code> association defines a Child Association between folders (<code>cm:folder</code>) and all other objects (instances of <code>sys:base</code> or its child types). So, for example, a folder named “Human Resources” (an instance of <code>cm:folder</code>) would have a <code>cm:contains</code> association between itself and all of its immediate children. The children could be instances of custom types like Resume, Policy, or Performance Review.</p>
<p>Another example might be a “Whitepaper” and its “Related Documents”. Suppose that a company publishes whitepapers on their web site. The whitepaper might be related to other documents such as product marketing materials or other research. If the relationship between the whitepaper and its related documents is formalized it can be shown in the user interface. To implement this, as part of the Whitepaper content type, you'd define a Peer Association. You could use <code>sys:base</code> as the target type to allow any piece of content in the repository to be associated with a Whitepaper or you could restrict the association to a specific type like <code>cm:content</code> or <code>sc:whitepaper</code>.</p>
<h3 id="aspects">Aspects</h3>
<p>Before discussing <em>Aspects</em>, let's first consider how inheritance works and the implications on the content model. Suppose Alfresco will be used to manage content to be displayed in a portal (quite a common requirement, by the way). Suppose further that only a subset of the content in the repository is content that should be shown in the portal. And, when content is to be displayed in the portal, there are some additional pieces of metadata that need to be captured. A simple example might be a requirement to show the date and time a piece of content was approved.</p>
<p>Using the content modeling concepts discussed so far, there are only two options. The first option is to define a root content type with the “publish date” property. All subsequent content types would inherit from this root type thus making the publish date available everywhere. The second option is to individually define the publish date property only in the content types that are going to be published to the portal.</p>
<p>Neither of these are great options. In the first option, there would be a property in each-and-every piece of content in the repository that may or may not ultimately be used which can lead to performance and maintenance problems. The second option isn't much better for a few reasons. First, it assumes the content types to be published in the portal are known ahead of time. Second, it opens up the possibility that the same type of metadata might get defined differently across content types. Last, it doesn't provide an easy way to encapsulate behavior or business logic that might be tied to the publish date.</p>
<p>As you have probably figured out by now, there is a third option that addresses these issues: Aspects. Aspects “cross-cut” the content model with properties and associations by attaching them to content types (or even specific instances of content) when and where they are needed.</p>
<p>Going back to the portal example, a “Portal Displayable” aspect could be defined with a publish date property. The aspect would then be added to any piece of content, regardless of type, that needed to be displayed in the portal.</p>
<h3 id="custom-behavior">Custom Behavior</h3>
<p>You may find that your custom aspect or custom type needs to have behavior or business logic associated with it. For example, every time an Expense Report is checked in you want to recalculate the total by iterating through the associated Expenses. One option would be to incorporate this logic into rules or actions in the Alfresco web client or your custom web application. But some behavior is so fundamental to the aspect or type that it should really be “bound” to the aspect or type and invoked any time Alfresco works with those objects. If you are curious how this works, read the <a href="http://ecmarchitect.com/alfresco-developer-series">Custom Behaviors tutorial</a> on ecmarchitect.com. For now, just know that associating business logic with your custom aspects and types (or overriding out-of-the-box behavior) is possible.</p>
<h3 id="content-modeling-best-practices">Content Modeling Best Practices</h3>
<p>Now that you know the building blocks of a content model, it makes sense to consider some best practices. Here are the top ten:</p>
<ol style="list-style-type: decimal">
<li><p><em>Don't change Alfresco's out-of-the-box content model</em>. If you can possibly avoid it, do not change Alfresco's out-of-the-box content model. Instead, extend it with your own custom content model. If requirements call for several different types of content to be stored in the repository, create a content type for each one that extends from <code>cm:content</code> or from an enterprise-wide root content type.</p></li>
<li><p><em>Consider implementing an enterprise-wide root type</em>. Although the need for a common ancestor type is lessened through the use of aspects, it still might be a good idea to define an enterprise-wide root content type from which all other content types in the repository inherit if for no other reason than it gives content managers a “catch-all” type to use when no other type will do.</p></li>
<li><p><em>Be conservative early on by adding only what you know you need</em>. A corollary to that is <em>prepare yourself to blow away the repository multiple times until the content model stabilizes</em>. Once you get content in the repository that implements the types in your model, making model additions is easy, but subtractions aren't. Alfresco will complain about “integrity errors” and may make content inaccessible when the content's type or properties don't match the content model definition. When this happens to you (and it will happen) your options are to either (1) leave the old model in place, (2) attempt to export the content, modify the ACP XML file, and re-import, or (3) drop the Alfresco tables, clear the data directory, and start fresh. As long as everyone on the team is aware of this, option three is not a big deal in development, but make sure expectations are set appropriately and have a plan for handling model changes once you get to production. This might be an area where Alfresco will improve in future releases, but for now it is something you have to watch out for.</p></li>
<li><p><em>Avoid unnecessary content model depth</em>. I am not aware of any Alfresco Content Modeling Commandments that say, “Thou shall not exceed X levels of depth in thine content model lest thou suffer the wrath of poor performance” but it seems logical that degradation would occur at some point. If your model has several levels of depth beyond <code>cm:content</code>, you should at least do a proof-of-concept with a realistic amount of data, software, and hardware to make sure you aren't creating a problem for yourself that might be very difficult to reverse down the road.</p></li>
<li><p><em>Take advantage of aspects</em>. In addition to the potential performance and overhead savings through the use of aspects, aspects promote reuse across the model, the business logic, and the presentation layer. When working on your model you find that two or more content types have properties in common, ask yourself if those properties are being used to describe some higher-level characteristic common across the types that might better be modeled as an aspect.</p></li>
<li><p><em>It may make sense to define types that have no properties or associations</em>. You may find yourself defining a type that gets everything it needs through either inheritance from a parent type or from an aspect (or both). In those cases you might ask yourself if the “empty” type is really necessary. In my opinion, it should at least be considered. It might be worth it just to distinguish the content from other types of content for search purposes, for example. Or, while you might not have any specialized properties or associations for the content type you could have specialized behavior that's only applicable to instances of the content type.</p></li>
<li><p><em>Remember that folders are types too</em>. Like everything else in the model, folders are types which means they can be extended. Content that “contains” other content is common. In the earlier expense report example, one way to keep track of the expenses associated with an expense report would be to model the expense report as a sub-type of <code>cm:folder</code>.</p></li>
<li><p><em>Don't be afraid to have more than one content model XML file</em>. You’ll see how content models are defined shortly, but when it is time to implement your model, keep this in mind: It might make sense to segment your models into multiple namespaces and multiple XML files. Names should be descriptive. Don't deploy a model file called “customModel.xml” or “myModel.xml”.</p></li>
<li><p><em>Implement a Java class that corresponds to each custom content model you define</em>. Within each content model Java class, define constants that correspond to model namespaces, type names, property names, aspect names, etc. You'll find yourself referring to the “Qname” of types, properties, and aspects quite often so it helps to have constants defined in an intuitive way.</p></li>
<li><p><em>Use the source</em>! The out-of-the-box content model is a great example of what's possible. The forumModel and recordsModel have some particularly useful examples. In the next section I'll tell you where the model files live and what's in each so you'll know where to look later when you say to yourself, “Surely, the folks at Alfresco have done this before”.</p></li>
</ol>
<h3 id="out-of-the-box-models">Out-of-the-Box Models</h3>
<p>The Alfresco source code is an indispensable reference tool which you should always have at the ready, along with the documentation, wiki, forums, and Jira. With that said, if you are following along with this article but have not yet downloaded the source, you are in luck. The out-of-the-box content model files are written in XML and get deployed with the web client. They can be found in the alfresco.war inside various JAR files stored in /WEB-INF/lib. The table below describes several of the out-of-the-box model files.</p>
<table>
<caption>Some Out-of-the-Box Content Models</caption>
<thead>
<tr class="header">
<th align="left">JAR</th>
<th align="left">File</th>
<th align="left">Namespaces</th>
<th align="left">Prefix</th>
<th align="left">Imports</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alfresco-data-model-[version].jar</td>
<td align="left">dictionaryModel.xml</td>
<td align="left">model/dictionary/1.0</td>
<td align="left">d</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">alfresco-repository-[version].jar</td>
<td align="left">systemModel.xml</td>
<td align="left">model/system/1.0</td>
<td align="left">sys</td>
<td align="left">d</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">system/registry/1.0</td>
<td align="left">reg</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">system/modules/1.0</td>
<td align="left">module</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">alfresco-repository-[version].jar</td>
<td align="left">contentModel.xml</td>
<td align="left">model/content/1.0</td>
<td align="left">cm</td>
<td align="left">d, sys</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">model/rendition/1.0</td>
<td align="left">rn</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">model/exif/1.0</td>
<td align="left">exif</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">model/audio/1.0</td>
<td align="left">audio</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">model/webdav/1.0</td>
<td align="left">webdav</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">alfresco-repository-[version].jar</td>
<td align="left">bpmModel.xml</td>
<td align="left">model/bpm/1.0</td>
<td align="left">bpm</td>
<td align="left">d, sys, cm, usr</td>
</tr>
<tr class="odd">
<td align="left">alfresco-repository-[version].jar</td>
<td align="left">forumModel.xml</td>
<td align="left">model/forum/1.0</td>
<td align="left">fm</td>
<td align="left">d, cm</td>
</tr>
</tbody>
</table>
<p>In the interest of brevity, I've left off about 25 other model files. Depending on what you are trying to do with your model, or just to see further examples, you might want to take a look at those at some point.</p>
<p>In addition to the model files the modelSchema.xsd file can be a good reference. As the name suggests, it defines the XML vocabulary Alfresco content model XML files must adhere to.</p>
<h2 id="creating-a-custom-content-model">Creating a Custom Content Model</h2>
<p>Time for a detailed example. As mentioned earlier, suppose Alfresco is being implemented for a fictional company called “SomeCo”. Pretend that SomeCo is a commercial open source company behind the ever-popular open source project, “SomeSoftware”. SomeCo has decided to re-vamp its web presence by adding new types of content and social functionality to their web site. For this example, let’s focus on the white papers SomeCo wants to make available.</p>
<p>SomeCo has selected Alfresco as their Enterprise Content Management solution. In addition to managing the content on the new site, SomeCo wants to use Alfresco to manage all of its rich content. So everything will live in the Alfresco repository and some subset of the company’s content will be served up to the external portal.</p>
<p>The first step is to consider the types and properties needed. There are some pieces of metadata SomeCo wants to track about all content, regardless of whether or not it will be shown on the web site. All documents will have an audience property that identifies who will be most interested in the content. Documents related to SomeCo's software will have properties identifying the Software Product and Software Version.</p>
<p>Content that needs to be shown on the web site needs to have a flag that indicates the content is “active” and a date when the content was set to active.</p>
<p>Now let's think about associations. For some documents, SomeCo would like to explicitly define one or more “related documents”. On the web site, SomeCo might choose to show a list of related documents at the bottom of a white paper, for example.</p>
<p>Taking these requirements into consideration, the team comes up with the content model depicted below:</p>
<div class="figure">
<img src="./images/model.png" alt="SomeCo&#39;s initial content model" /><p class="caption">SomeCo's initial content model</p>
</div>
<p>As the drawing shows, there is a common root type called <code>sc:doc</code> with one child, <code>sc:whitepaper</code>. Neither type currently has any properties of their own.</p>
<p>It's not shown on the model diagram, but there is a Peer Association defined as part of <code>sc:doc</code> to keep track of related documents. The target class of the association will be <code>sc:doc</code> because the requirement is to be able to associate any instance of <code>sc:doc</code> or its children with one or more instances of <code>sc:doc</code> or its children.</p>
<p>In addition, there are two aspects. One, the <code>sc:webable</code> aspect, is used for content that is to be shown on the web site. It contains the <code>sc:isActive</code> flag and <code>sc:published</code> date. The <code>sc:productRelated</code> aspect is used only for content that relates to a SomeCo product. It captures the specific product name the content is related to as well as the product version.</p>
<p>It should be easy to see how the model might be extended over time. The requirements mentioned social features being needed at some point. A rateable aspect could be added along with a rating type. Comments could work the same way. Or you could choose to use the rating and commenting features available out-of-the-box.</p>
<p>As new content types are identified they will be added under <code>sc:doc</code>.</p>
<p>Using the aspect to determine whether or not to show the content on the portal is handy, particularly in light of the SomeCo decision to use Alfresco for all of its content management needs. The repository will contain content that may or may not be on the portal. Portal content will be easily-distinguishable from non-portal content by the presence of the <code>sc:webable</code> aspect.</p>
<h3 id="setting-up">Setting Up</h3>
<p>Before starting, let's get a local development environment set up. First I'll give you a list of the tools you'll need, then I'll explain the project organization.</p>
<h4 id="tools">Tools</h4>
<p>Here is what I am using on my machine:</p>
<ul>
<li>Mac OS X 10.10.5</li>
<li>Java 1.8.0_31</li>
<li>Apache Maven 3.3.3 (installed using Macports)</li>
<li>Alfresco Maven SDK 2.1 (No download necessary)</li>
<li>Eclipse Java EE IDE for Web Developers, Luna</li>
</ul>
<p>By default, when you create an Alfresco project using version 2.1 of the Alfresco Maven SDK the project will be configured to depend on Alfresco Community Edition 5.0.d.</p>
<p>If you are using Alfresco 4.x you must use Alfresco Maven SDK 1.0. The 2.x SDK will not work with Alfresco 4.x.</p>
<p>Projects created using the Alfresco Maven SDK have the ability to run Alfresco on an embedded Tomcat server. This makes <a href="http://www.alfresco.com/products/community">downloading</a> and installing Alfresco optional. But if you want to run a full Alfresco server locally, you are welcome to do that.</p>
<p>The Eclipse IDE is also optional. Most people working with Alfresco use Eclipse or something similar, so this tutorial will assume that's what you are using.</p>
<h4 id="project-organization">Project Organization</h4>
<p>I am going to use the Alfresco Maven SDK to create projects that will package up my customizations as AMPs (Alfresco Module Packages). I will ultimately create two AMPs. One AMP is for the Alfresco web application (the &quot;repo&quot; tier) and the other is for the Alfresco Share web application (the &quot;Share&quot; tier). Unless you have a good reason to do otherwise, this should be your default approach to packaging and deploying your customizations.</p>
<p>Normally, your custom content model would use two projects--one for the repo tier AMP and one for the Share tier AMP. But, because of how I am structuring this and other tutorials, I'm going to use some extra projects. If you follow the entire tutorial you will end up creating four:</p>
<ul>
<li><strong>content-tutorial-repo</strong>: This project creates the repo tier AMP. It contains the custom content model declaration. You'll create this project in Part 1 of this tutorial.</li>
<li><strong>content-tutorial-share</strong>: This project creates the Share tier AMP. It contains the Alfresco Share user interface configuration. You'll create this project in Part 2 of this tutorial.</li>
<li><strong>content-tutorial-cmis</strong>: This project contains runnable Java classes that show how to use the CMIS API to perform CRUD functions against content that leverages your custom content model. You'll create this project in Part 3 of this tutorial.</li>
<li><strong>content-tutorial-common</strong>: This project contains some utility classes that are leveraged by the rest of the projects in this (and other) tutorials. You'll also create this project in Part 3.</li>
</ul>
<p>From an Apache Maven perspective, each of the four projects will have their own pom.xml. Then I'll use a single pom.xml in the root that builds all four projects.</p>
<p>Speaking of Apache Maven, I am not going to spend much time talking about how the Alfresco Maven SDK works. If you aren't already familiar with it, you may want to read the <a href="http://ecmarchitect.com/alfresco-developer-series">Getting Started with the Alfresco Maven SDK</a> tutorial on ecmarchitect.com first and then come back to this one.</p>
<h3 id="implementing-and-deploying-the-model">Implementing and Deploying the Model</h3>
<p>Here are the steps to follow when configuring a custom content model:</p>
<ol style="list-style-type: decimal">
<li>Create a new AMP project using the Alfresco Maven SDK</li>
<li>Create a custom content model XML file</li>
<li>Register the new model XML file using a Spring bean</li>
<li>Test your changes</li>
</ol>
<p>Let's go through each of these.</p>
<h4 id="step-1-create-a-new-amp-project">Step 1: Create a new AMP Project</h4>
<p>The first step is to <strong>create a new AMP project</strong> using the Alfresco Maven SDK. Follow these steps:</p>
<ol style="list-style-type: decimal">
<li>If you have not already done so, create an empty directory that can hold the new projects associated with this tutorial. I'll refer to that as $TUTORIAL_HOME.</li>
<li><p>Now use the Alfresco Maven SDK to create a project for the repo tier AMP. Using the command line, change directories to $TUTORIAL_HOME, then run:</p>
<pre><code>mvn archetype:generate -Dfilter=org.alfresco:</code></pre></li>
<li>Choose the Alfresco AMP archetype (option 2).</li>
<li>Choose version 2.1.1 of the archetype (option 5).</li>
<li>Specify &quot;com.someco&quot; for the <code>groupId</code>.</li>
<li>Specify &quot;content-tutorial-repo&quot; for the <code>artifactId</code>.</li>
<li><p>If Eclipse isn't running, start it up. Use File, Import, Maven, Existing Maven Projects to import the content-tutorial-repo project you just created.</p></li>
</ol>
<p>If you have problems after the import, go ahead and resolve those. Consult the Alfresco Maven SDK tutorial if you need help with that.</p>
<p>Now you are ready to create your custom content model XML.</p>
<h4 id="step-2-create-a-custom-content-model-xml-file">Step 2: Create a custom content model XML file</h4>
<p>Now that you have a project that is ready to produce a repo tier AMP you can create your content model XML file. To do that, follow these steps:</p>
<ol style="list-style-type: decimal">
<li><p>Models belong in a directory called “model” in your project's module directory, which is:</p>
<pre><code>$TUTORIAL_HOME/content-tutorial-repo/src/main/amp/config/alfresco/module/content-tutorial-repo</code></pre>
The &quot;model&quot; directory does not exist when the project is initially created by the Alfresco Maven SDK, so go ahead and create it now in the directory above.</li>
<li>Custom models live in the model directory as XML. Create a new XML file in the model directory called &quot;scModel.xml&quot;. The name of the file isn't important but you should choose a name that will help you and your team distinguish it from other model files you might add to this directory over time.</li>
<li><p>Copy the following XML into the scModel.xml file and save.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!-- Definition of new Model --&gt;
&lt;model name=&quot;sc:somecomodel&quot; xmlns=&quot;http://www.alfresco.org/model/dictionary/1.0&quot;&gt;
    &lt;!-- Optional meta-data about the model --&gt;
    &lt;description&gt;Someco Model&lt;/description&gt;
    &lt;author&gt;Jeff Potts&lt;/author&gt;
    &lt;version&gt;1.0&lt;/version&gt;

    &lt;!-- Imports are required to allow references to definitions in other models --&gt;
    &lt;imports&gt;
        &lt;!-- Import Alfresco Dictionary Definitions --&gt;
        &lt;import uri=&quot;http://www.alfresco.org/model/dictionary/1.0&quot; prefix=&quot;d&quot; /&gt;
        &lt;!-- Import Alfresco Content Domain Model Definitions --&gt;
        &lt;import uri=&quot;http://www.alfresco.org/model/content/1.0&quot; prefix=&quot;cm&quot; /&gt;
    &lt;/imports&gt;

    &lt;!-- Introduction of new namespaces defined by this model --&gt;
    &lt;namespaces&gt;
        &lt;namespace uri=&quot;http://www.someco.com/model/content/1.0&quot; prefix=&quot;sc&quot; /&gt;
    &lt;/namespaces&gt;
    &lt;constraints&gt;
        &lt;constraint name=&quot;sc:campaignList&quot; type=&quot;LIST&quot;&gt;
            &lt;parameter name=&quot;allowedValues&quot;&gt;
                &lt;list&gt;
                    &lt;value&gt;Application Syndication&lt;/value&gt;
                    &lt;value&gt;Private Event Retailing&lt;/value&gt;
                    &lt;value&gt;Social Shopping&lt;/value&gt;
                &lt;/list&gt;
            &lt;/parameter&gt;
        &lt;/constraint&gt;
    &lt;/constraints&gt;

    &lt;types&gt;
        &lt;!-- Enterprise-wide generic document type --&gt;
        &lt;type name=&quot;sc:doc&quot;&gt;
            &lt;title&gt;Someco Document&lt;/title&gt;
            &lt;parent&gt;cm:content&lt;/parent&gt;
            &lt;associations&gt;
                &lt;association name=&quot;sc:relatedDocuments&quot;&gt;
                    &lt;title&gt;Related Documents&lt;/title&gt;
                    &lt;source&gt;
                        &lt;mandatory&gt;false&lt;/mandatory&gt;
                        &lt;many&gt;true&lt;/many&gt;
                    &lt;/source&gt;
                    &lt;target&gt;
                        &lt;class&gt;sc:doc&lt;/class&gt;
                        &lt;mandatory&gt;false&lt;/mandatory&gt;
                        &lt;many&gt;true&lt;/many&gt;
                    &lt;/target&gt;
                &lt;/association&gt;
            &lt;/associations&gt;
            &lt;mandatory-aspects&gt;
                &lt;aspect&gt;cm:generalclassifiable&lt;/aspect&gt;
            &lt;/mandatory-aspects&gt;
        &lt;/type&gt;

        &lt;type name=&quot;sc:whitepaper&quot;&gt;
            &lt;title&gt;Someco Whitepaper&lt;/title&gt;
            &lt;parent&gt;sc:doc&lt;/parent&gt;
        &lt;/type&gt;

        &lt;type name=&quot;sc:marketingDoc&quot;&gt;
            &lt;title&gt;Someco Marketing Document&lt;/title&gt;
            &lt;parent&gt;sc:doc&lt;/parent&gt;
            &lt;properties&gt;
                &lt;property name=&quot;sc:campaign&quot;&gt;
                    &lt;type&gt;d:text&lt;/type&gt;
                    &lt;multiple&gt;true&lt;/multiple&gt;
                    &lt;constraints&gt;
                        &lt;constraint ref=&quot;sc:campaignList&quot; /&gt;
                    &lt;/constraints&gt;
                &lt;/property&gt;
            &lt;/properties&gt;
        &lt;/type&gt;

    &lt;/types&gt;

    &lt;aspects&gt;
        &lt;aspect name=&quot;sc:webable&quot;&gt;
            &lt;title&gt;Someco Webable&lt;/title&gt;
            &lt;properties&gt;
                &lt;property name=&quot;sc:published&quot;&gt;
                    &lt;type&gt;d:date&lt;/type&gt;
                &lt;/property&gt;
                &lt;property name=&quot;sc:isActive&quot;&gt;
                    &lt;type&gt;d:boolean&lt;/type&gt;
                    &lt;default&gt;false&lt;/default&gt;
                &lt;/property&gt;
            &lt;/properties&gt;
        &lt;/aspect&gt;

        &lt;aspect name=&quot;sc:productRelated&quot;&gt;
            &lt;title&gt;Someco Product Metadata&lt;/title&gt;
            &lt;properties&gt;
                &lt;property name=&quot;sc:product&quot;&gt;
                    &lt;type&gt;d:text&lt;/type&gt;
                    &lt;mandatory&gt;true&lt;/mandatory&gt;
                    &lt;multiple&gt;true&lt;/multiple&gt;
                &lt;/property&gt;             
                &lt;property name=&quot;sc:version&quot;&gt;
                    &lt;type&gt;d:text&lt;/type&gt;
                    &lt;mandatory&gt;true&lt;/mandatory&gt;
                    &lt;multiple&gt;true&lt;/multiple&gt;
                &lt;/property&gt;
            &lt;/properties&gt;
        &lt;/aspect&gt;
    &lt;/aspects&gt;
&lt;/model&gt;</code></pre></li>
</ol>
<p>Referring back to the earlier drawing of SomeCo's initial content model, you'll see that it matches up with the XML above with a small exception. As shown in the diagram, there are two aspects, each with two properties, the enterprise-wide ancestor type called <code>sc:doc</code>, a type for whitepapers called <code>sc:whitepaper</code>, and a third type, <code>sc:marketingDoc</code>, which I added so you could see an example of how constraints work.</p>
<p>When building your own custom content models, you may want to use the out-of-the-box contentModel.xml, discussed earlier, as a reference.</p>
<p>Here's an important note about the content model schema that may save you some time: Order matters. For example, if you move the <code>associations</code> element after <code>mandatory-aspects</code> Alfresco won't be able to parse your model. Refer to the modelSchema.xsd referenced earlier to determine the expected order.</p>
<h4 id="step-3-register-the-new-model-with-a-spring-bean">Step 3: Register the new model with a Spring bean</h4>
<p>The next step is to <strong>register the new model with a Spring bean</strong> in a Spring context file. You'll find that the Alfresco Maven SDK has already created a Spring context file for your module in:</p>
<pre><code>$TUTORIAL_HOME/content-tutorial-repo/src/main/amp/config/alfresco/module/content-tutorial-repo/context</code></pre>
<p>The file is named service-context.xml. If you open that file you'll see that two Spring beans are already there. They were created by the Alfresco Maven SDK and they are used to wire in some example classes.</p>
<p>To register the custom content model with Spring, all we have to do is add a new <code>bean</code> element to the list of <code>beans</code>. The new <code>bean</code> element looks like this:</p>
<pre><code>&lt;!-- Registration of new models --&gt;
&lt;bean id=&quot;${project.artifactId}_dictionaryBootstrap&quot; parent=&quot;dictionaryModelBootstrap&quot; depends-on=&quot;dictionaryBootstrap&quot;&gt;
    &lt;property name=&quot;models&quot;&gt;
        &lt;list&gt;
            &lt;value&gt;alfresco/module/${project.artifactId}/model/scModel.xml&lt;/value&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;</code></pre>
<p>Notice the <code>${project.artifactId}</code> placeholder. That will be automatically replaced by the Alfresco Maven SDK using the <code>artifactId</code> specified in the pom.xml file when Maven generates the AMP.</p>
<h4 id="step-4-test-your-changes">Step 4: Test Your Changes</h4>
<p>The last step is to test your changes. The Alfresco Maven SDK makes that easy. Do this:</p>
<ol style="list-style-type: decimal">
<li>From the command line, change directories to $TUTORIAL_HOME/content-tutorial-repo.</li>
<li><p>Run:</p>
<pre><code>mvn install</code></pre></li>
</ol>
<p>The first time you do this it may take quite a while. Maven is downloading everything it needs to run Alfresco in an embedded Tomcat server along with your custom content model.</p>
<p>If everything goes as expected you should see:</p>
<pre><code>[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1:38.455s
[INFO] Finished at: Wed Jan 22 12:55:48 CST 2014
[INFO] Final Memory: 38M/203M
[INFO] ------------------------------------------------------------------------</code></pre>
<p>If you get a build failure, it is time to debug. Make sure that:</p>
<ul>
<li>The bean in service-context.xml refers to the proper path and file name of your custom content model XML file.</li>
<li>Your custom content model XML file is well-formed and valid.</li>
</ul>
<p>If you still have problems, post as much detail as you can in the <a href="http://forums.alfresco.com">Alfresco Forums</a>.</p>
<h4 id="success">Success</h4>
<p>You have now created an AMP that contains a custom content model. If you go look in:</p>
<pre><code>$TUTORIAL_HOME/content-tutorial-repo/target</code></pre>
<p>you'll see a file named content-tutorial-repo.amp. That AMP can be installed in an Alfresco installation. For example, if you are running Alfresco using the binary installer, you can copy the AMP to <code>$ALFRESCO_HOME/amps</code> and then run <code>$ALFRESCO_HOME/bin/apply_amps.sh</code> to install the AMP into your Alfresco web application.</p>
<p>For the purpose of this tutorial, though, let's keep moving. You've got your content model defined but the Alfresco Share user interface doesn't know anything about it yet. You'll learn how to do that next.</p>
<h1 id="part-2-configuring-alfresco-share">Part 2: Configuring Alfresco Share</h1>
<p>Now that the model is defined, you could begin using it right away by writing code against one of Alfresco's API's that creates instances of your custom types, adds aspects, etc. In practice it is usually a good idea to do just that to make sure the model behaves like you expect. In fact, if you just can’t wait to see some code to create, query, and update content, skip to <a href="#part-3-working-with-content-programmatically">Part 3</a>. For everyone else, let's talk about how to configure Alfresco Share so that end-users can work with the custom content model you just created.</p>
<h2 id="configuring-the-custom-model-in-alfresco-share">Configuring the Custom Model in Alfresco Share</h2>
<p>Let’s continue by configuring Alfresco Share to work with our custom content model.</p>
<p>First, think about the Alfresco Share client and all of the places the content model customizations need to show up:</p>
<ul>
<li><p><strong>“Is sub-type” criteria</strong>. When a user configures a rule on a space and uses content types as a criteria, the custom types should be a choice in the list of possible content types.</p></li>
<li><p><strong>“Has aspect” criteria</strong>. When a user configures a rule on a space and uses the presence of an aspect as a criteria, the custom aspects should be a choice in the list of possible aspects.</p></li>
<li><p><strong>Change type action</strong>. When a user runs the “specialize type” action, either as part of a rule configuration or through the “Change Type” UI action, the custom types should be available.</p></li>
<li><p><strong>Add aspect</strong>. When a user runs the “add aspect” action, either as part of a rule configuration or through the “Manage Aspects” UI action, the custom aspects should be available.</p></li>
<li><p><strong>Document Details</strong>. When a user looks at the document details page for a piece of content stored as one of the custom types or with one of the custom aspects attached, the properties section should show the custom properties.</p></li>
<li><p><strong>Edit Properties</strong>. When a user edits the properties of a piece of content, either with the “full” form or the abbreviated form, the appropriate properties should be shown.</p></li>
<li><p><strong>Advanced search</strong>. When a user runs an advanced search, they should be able to restrict search results to instances of our custom types and/or content with specific values for the properties of our custom types.</p></li>
</ul>
<p>Let's configure Alfresco Share to make each of the areas mentioned above work with our custom content model. To do that, we're going to:</p>
<ol style="list-style-type: decimal">
<li>Use the Alfresco Maven SDK to create a new project that will produce a Share tier AMP.</li>
<li>Create a custom Share configuration file.</li>
<li>Test our changes.</li>
</ol>
<p>Let's do it.</p>
<h3 id="step-1-create-a-project-for-the-share-tier-amp">Step 1: Create a project for the Share tier AMP</h3>
<p>The first step is to create a new project to hold the files that will make up the Share tier AMP. That works exactly as it did for the repo tier AMP. Do this:</p>
<ol style="list-style-type: decimal">
<li>Change directories to $TUTORIAL_HOME, then create a new project using Alfresco Maven SDK.</li>
<li>This time, specify the Share AMP archetype (option 3).</li>
<li>Specify &quot;com.someco&quot; as the <code>groupId</code>.</li>
<li>Specify &quot;content-tutorial-share&quot; as the <code>artifactId</code>.</li>
</ol>
<p>Now you are ready to create a custom Share configuration file.</p>
<h3 id="step-2-create-a-custom-share-configuration-file">Step 2: Create a custom Share configuration file</h3>
<p>Alfresco Share uses a configuration file called &quot;share-config-custom.xml&quot;. The share-config-custom.xml file is a proprietary file composed of numerous “config” elements. Each config element has an “evaluator” and a “condition”. Extending the out-of-the-box Share configuration is a matter of knowing which evaluator/condition to use.</p>
<p>The location of the share-config-custom.xml file is a little counter-intuitive. Ultimately, we want that file to be placed under META-INF in a JAR file that will go into the Share web application's WEB-INF/lib. Putting the file in a JAR keeps it from overwriting other modules that may also be providing their own share-config-custom.xml.</p>
<p>Create an empty XML file called &quot;share-config-custom.xml&quot; in:</p>
<pre><code>$TUTORIAL_HOME/content-tutorial-share/src/main/resources/META-INF</code></pre>
<p>We'll add to that file in the next sections.</p>
<h4 id="add-custom-types-and-aspects-to-lists">Add Custom Types and Aspects to Lists</h4>
<p>The first four items in our configuration wish list have to do with telling the Share user interface about custom types and aspects. A single set of configuration will take care of all four items.</p>
<ol style="list-style-type: decimal">
<li><p>Edit the share-config-custom.xml file you just created and add the following:</p>
<pre><code>&lt;alfresco-config&gt;
    &lt;!-- Document Library config section --&gt;
    &lt;config evaluator=&quot;string-compare&quot; condition=&quot;DocumentLibrary&quot;&gt;
    &lt;/config&gt;
&lt;/alfresco-config&gt;</code></pre></li>
<li><p>Now add an <code>aspects</code> element as a child of the <code>config</code> element to identify the aspects that are visible, addable, and removeable:</p>
<pre><code>&lt;aspects&gt;
    &lt;!-- Aspects that a user can see --&gt;
    &lt;visible&gt;
        &lt;aspect name=&quot;sc:webable&quot; /&gt;
        &lt;aspect name=&quot;sc:productRelated&quot; /&gt;            
    &lt;/visible&gt;

    &lt;!-- Aspects that a user can add. Same as &quot;visible&quot; if left empty --&gt;
    &lt;addable&gt;
    &lt;/addable&gt;

    &lt;!-- Aspects that a user can remove. Same as &quot;visible&quot; if left empty --&gt;
    &lt;removeable&gt;
    &lt;/removeable&gt;
&lt;/aspects&gt;</code></pre>
As the comments suggest, the <code>addable</code> and <code>removeable</code> elements can remain empty if the list is the same.</li>
<li><p>That takes care of aspects. Let’s configure the types. Add a <code>types</code> element as a sibling to the <code>aspects</code> element you just added with the following content:</p>
<pre><code>&lt;types&gt;
    &lt;type name=&quot;cm:content&quot;&gt;
        &lt;subtype name=&quot;sc:doc&quot; /&gt;
        &lt;subtype name=&quot;sc:whitepaper&quot; /&gt;
    &lt;/type&gt;
    &lt;type name=&quot;sc:doc&quot;&gt;
        &lt;subtype name=&quot;sc:whitepaper&quot; /&gt;
    &lt;/type&gt;
&lt;/types&gt;</code></pre></li>
</ol>
<p>Notice how <code>sc:whitepaper</code> appears in the list twice—once as a subtype of <code>cm:content</code> and once as a subtype of <code>sc:doc</code>. This allows a user to specialize directly to the <code>sc:whitepaper</code> type regardless of whether the original type is <code>cm:content</code> or <code>sc:doc</code>.</p>
<h3 id="step-3-test-your-changes">Step 3: Test Your Changes</h3>
<p>You need two things to test this: An Alfresco repository that is running the repo tier AMP you created in Part 1 and an Alfresco Share web application running the Share tier AMP you just started working on. One way to do this is to leverage the embedded Tomcat server present in both projects. Do this:</p>
<ol style="list-style-type: decimal">
<li>Open two command line windows.</li>
<li>In the first window, switch to $TUTORIAL_HOME/content-tutorial-repo.</li>
<li><p>Run:</p>
<pre><code>mvn integration-test -Pamp-to-war</code></pre>
This will start up an Alfresco server with your repo tier AMP and it will leave it running.</li>
<li>In the second window, switch to $TUTORIAL_HOME/content-tutorial-share.</li>
<li><p>Run:</p>
<pre><code>mvn integration-test -Pamp-to-war -Dmaven.tomcat.port=8081</code></pre>
<p>This will start up Alfresco Share running on port 8081. It will automatically connect to the Alfresco server you just started, which is running on port 8080.</p></li>
</ol>
<p>Now open your browser and point it to http://localhost:8081/share. Log in using admin/admin and let’s see what’s different.</p>
<p>What’s different is that the “is sub-type” dropdown in the rule configuration panel now has our custom types and the “has aspect” dropdown now has our custom aspects.</p>
<div class="figure">
<img src="./images/type-check-hi.png" alt="Rule configuration with custom types" /><p class="caption">Rule configuration with custom types</p>
</div>
<div class="figure">
<img src="./images/has-aspect-hi.png" alt="Rule configuration with custom aspects" /><p class="caption">Rule configuration with custom aspects</p>
</div>
<p>The “change type” dropdown, in both the rule configuration and UI action, lists our custom types:</p>
<div class="figure">
<img src="./images/specialize-type-hi.png" alt="Specialize type action with in rule config" /><p class="caption">Specialize type action with in rule config</p>
</div>
<div class="figure">
<img src="./images/change-type-before-i18n-hi.png" alt="Manage types UI action with custom types" /><p class="caption">Manage types UI action with custom types</p>
</div>
<p>And the “add aspect” list, in both the rule configuration and UI action, lists our custom aspects:</p>
<div class="figure">
<img src="./images/add-aspect-hi.png" alt="Add aspect action with custom actions" /><p class="caption">Add aspect action with custom actions</p>
</div>
<div class="figure">
<img src="./images/aspects-before-i18n-hi.png" alt="Manage aspects UI action with custom aspects" /><p class="caption">Manage aspects UI action with custom aspects</p>
</div>
<p>You’ll notice that in the rule configuration the types and aspects are shown with their localized names while in the dialogs the strings are shown as not yet localized (their ID is displayed instead of their localized string). That’s because the strings for Share haven’t yet been localized and some services, like the rule configuration, will pull those strings from the content model XML. If it is annoying you, jump to the <a href="#localizing-strings-for-custom-content-models">localization</a> section and come back.</p>
<h2 id="configuring-forms-for-custom-properties">Configuring Forms for Custom Properties</h2>
<p>Try this: Create a piece of test content. Change its type to <code>sc:whitepaper</code> and add both of our custom aspects to it. Then, from the Document Library, click the &quot;Edit Properties&quot; link for that piece of test content. You'll see a form that looks something like this:</p>
<div class="figure">
<img src="./images/unconfigured-form.png" alt="Alfresco Share does not know how to display a form for the custom type" /><p class="caption">Alfresco Share does not know how to display a form for the custom type</p>
</div>
<p>When you compare this to the pop-up that is displayed for an instance of <code>cm:content</code> you will see a big difference. The edit properties dialog for <code>sc:whitepaper</code> is a jumbled mess. The locale is showing up for some reason. The title field is halfway down the form, which has grown extremely long with all sorts of fields.</p>
<p>What’s going on here is that Share is looking for a form configuration for <code>sc:whitepaper</code>. Finding none, it is just listing all of the properties of the object.</p>
<p>Content properties can be edited two ways:</p>
<ol style="list-style-type: decimal">
<li>Using the edit metadata popup dialog, which is what you get when you click “Edit Properties” from the document library page</li>
<li>Using the default form, which is what you get when you click “Edit Properties” from the document details page.</li>
</ol>
<p>Clearly something prettier is needed for both the default form and the edit metadata form, so let’s fix that.</p>
<h3 id="configuring-the-form-service-for-a-custom-type">Configuring the form service for a custom type</h3>
<p>Alfresco Share uses the Form Service to decide which properties to show for a given form, how to lay out forms, and the control to use for each property. Let’s take a look at the out-of-the-box form configuration for <code>cm:content</code>. Because you've already launched Alfresco Share on your embedded Tomcat server, the exploded Share web application exists in your project's target directory. The out-of-the-box share-form-config.xml file resides in target/content-tutorial-share-war/WEB-INF/classes/alfresco/share-form-config.xml.</p>
<p>If you open that file and search for ‘condition=”cm:content”’ you’ll find two config elements that contain a total of six form configurations. One config element, identified by the <code>node-type</code> evaluator, is for forms dealing with existing nodes. The config element with the <code>model-type</code> evaluator is for forms used to create new nodes.</p>
<p>Let’s focus on existing nodes for now. The three forms in that config element are:</p>
<ul>
<li>Default (<code>form</code> element with no <code>id</code> attribute). This is the form displayed when you open the document details.</li>
<li>A form called <code>doclib-simple-metadata</code>. This is used when you edit properties from the document library.</li>
<li>A form called <code>doclib-inline-edit</code>. This is used when you click the “Inline Edit” UI action.</li>
</ul>
<p>Suppose whitepapers need to have the same metadata displayed as instances of <code>cm:content</code>. To do that:</p>
<ol style="list-style-type: decimal">
<li>Copy the entire config element and all of its children into share-config-custom.xml as a sibling of the Document Library config element you added to that file earlier.</li>
<li>Then, change the condition from <code>cm:content</code> to <code>sc:whitepaper</code>.</li>
</ol>
<p>To test this change:</p>
<ol style="list-style-type: decimal">
<li>Go to the terminal window currently running your embedded Alfresco Share web application.</li>
<li>Click ctrl+c to stop the Alfresco Share server.</li>
<li><p>Re-run the server using:</p>
<pre><code>mvn integration-test -Pamp-to-war -Dmaven.tomcat.port=8081</code></pre></li>
</ol>
<p>There is no need to restart the Alfresco repository web application because nothing has changed in that AMP.</p>
<p>Now when you log in to Alfresco Share, you’ll see that the property sets match for <code>sc:whitepaper</code> and <code>cm:content</code> across all forms, as shown below:</p>
<div class="figure">
<img src="./images/configured-form.png" alt="Alfresco Share displays a form configured for the custom type" /><p class="caption">Alfresco Share displays a form configured for the custom type</p>
</div>
<p>Let's build on the form definition for <code>sc:whitepaper</code> to include properties and associations from the custom content model.</p>
<h3 id="configuring-the-form-service-for-custom-properties">Configuring the form service for custom properties</h3>
<p>The document details for a whitepaper looks better, but the form isn’t showing the custom metadata. In this particular example, our model defines an association called <code>sc:relatedDocuments</code> which <code>sc:whitepaper</code> inherits from <code>sc:doc</code> and four properties across two custom aspects.</p>
<p>For the properties defined in aspects, you have a choice. You can either add the properties to every form definition you want them to appear in. Or, you can add an aspect configuration so that they’ll automatically be displayed for any object that includes that aspect. The advantage of the former is that you can have fine-grained control over where those fields appear whereas if you choose the latter route, the form service will decide where to include your fields.</p>
<p>This example takes the latter route. Edit the share-config-custom.xml file and add the following aspect configuration for <code>sc:webable</code>:</p>
<pre><code>&lt;config evaluator=&quot;aspect&quot; condition=&quot;sc:webable&quot;&gt;
    &lt;forms&gt;
        &lt;form&gt;
            &lt;field-visibility&gt;
                &lt;show id=&quot;sc:published&quot; /&gt;
                &lt;show id=&quot;sc:isActive&quot; /&gt;
            &lt;/field-visibility&gt;
            &lt;appearance&gt;                    
                &lt;field id=&quot;sc:published&quot; label-id=&quot;prop.sc_published&quot; /&gt;
                &lt;field id=&quot;sc:isActive&quot; label-id=&quot;prop.sc_isActive&quot; /&gt;
            &lt;/appearance&gt;
        &lt;/form&gt;
    &lt;/forms&gt;
&lt;/config&gt;</code></pre>
<p>You can add the aspect configuration for <code>sc:productRelated</code> following the same pattern.</p>
<p>Notice that there are two elements you have to worry about—the <code>field-visibility</code> element defines which properties are on the form while the <code>appearance</code> element defines how those properties are rendered. In this example I’m showing only a <code>label-id</code>, but there are a lot of options here. For example, if you wanted to override the component used to display the property, this is where you’d do it.</p>
<p>Let’s take care of the <code>sc:relatedDocuments</code> association. It’s not defined in an aspect, so it is added directly to the form configuration for <code>sc:whitepaper</code>. It probably makes sense for the related documents property to be shown on both the default form and the edit metadata popup dialog. To do that, you’re going to modify the default form configuration element for <code>sc:whitepaper</code> that you created earlier. First add a <code>show</code> element just before the closing <code>field-visibility</code> tag:</p>
<pre><code>    &lt;!-- surf:widget aspect --&gt;
    &lt;show id=&quot;surf:widgetType&quot;/&gt;
    &lt;show id=&quot;surf:mid&quot;/&gt;
    &lt;show id=&quot;surf:label&quot;/&gt;

    &lt;!-- sc:doc --&gt;
    &lt;show id=&quot;sc:relatedDocuments&quot; /&gt;
&lt;/field-visibility&gt;</code></pre>
<p>Then, add a new <code>field</code> element just before the closing <code>appearance</code> tag:</p>
<pre><code>    &lt;field id=&quot;cm:addressees&quot; read-only=&quot;true&quot; /&gt;
    &lt;field id=&quot;cm:sentdate&quot; read-only=&quot;true&quot; /&gt;
    &lt;field id=&quot;cm:subjectline&quot; read-only=&quot;true&quot; /&gt;
    &lt;field id=&quot;sc:relatedDocuments&quot; label-id=&quot;assoc.sc_relatedDocuments&quot; /&gt;
&lt;/appearance&gt;</code></pre>
<p>Now do the same thing for the <code>doclib-simple-metadata</code> form.</p>
<p>After restarting the embedded Tomcat for your Alfresco Share project, you should see all four custom properties and the related documents association in the document details page, like this:</p>
<div class="figure">
<img src="./images/configured-doc-details.png" alt="Custom properties now show up in document details" /><p class="caption">Custom properties now show up in document details</p>
</div>
<p>Similarly, when you click &quot;Edit Properties&quot; from the document details page you should see the association and the properties:</p>
<div class="figure">
<img src="./images/configured-edit-props.png" alt="Custom properties now show up in edit properties" /><p class="caption">Custom properties now show up in edit properties</p>
</div>
<p>On the edit metadata pop-up dialog you should see the related documents association, like this:</p>
<div class="figure">
<img src="./images/configured-popup.png" alt="Custom properties now show up in document details" /><p class="caption">Custom properties now show up in document details</p>
</div>
<p>Now let's turn our attention to search.</p>
<h3 id="configuring-advanced-search-in-alfresco-share">Configuring Advanced Search in Alfresco Share</h3>
<p>The advanced search form in Alfresco Share allows end-users to first select what they are looking for and then specify both full-text and specific property values to search for depending on the content type selected. Out-of-the-box, the search form includes two types: <code>cm:content</code> and <code>cm:folder</code>.</p>
<p>Users need to be able to search specifically for SomeCo Whitepapers, so the first step is to add the <code>sc:whitepaper</code> type to the list. Like the other Share form configuration covered thus far, the configuration goes in share-config-custom.xml. In this case, the condition is <code>AdvancedSearch</code>.</p>
<pre><code>&lt;config replace=&quot;true&quot; evaluator=&quot;string-compare&quot; condition=&quot;AdvancedSearch&quot;&gt;
    &lt;advanced-search&gt;
        &lt;!-- Forms for the advanced search type list --&gt;
        &lt;forms&gt;
            &lt;form labelId=&quot;search.form.label.cm_content&quot; descriptionId=&quot;search.form.desc.cm_content&quot;&gt;cm:content&lt;/form&gt;
            &lt;form labelId=&quot;search.form.label.cm_folder&quot; descriptionId=&quot;search.form.desc.cm_folder&quot;&gt;cm:folder&lt;/form&gt;            
            &lt;form labelId=&quot;type.sc_whitepaper&quot; descriptionId=&quot;search.form.desc.sc_whitepaper&quot;&gt;sc:whitepaper&lt;/form&gt;
        &lt;/forms&gt;
    &lt;/advanced-search&gt;
&lt;/config&gt;</code></pre>
<p>Notice that the list of advanced search forms replaces the out-of-the-box list. If the list only had <code>sc:whitepaper</code> and left out <code>cm:content</code> and <code>cm:folder</code>, Share users would not be able to search for plain content or folders.</p>
<p>The next step is to tell Share which form to use when a given type is selected. Recall earlier that there are two sets of form configuration—one for existing nodes (evaluator of <code>node-type</code>) and one for new nodes (evaluator of <code>model-type</code>). Search forms go in the <code>model-type</code> evaluator.</p>
<p>The search form for whitepapers should be the same as the one for plain content, but should include the four properties defined in the custom aspects. The easiest way to do this is to copy the <code>cm:content</code> search form from the out-of-the-box form configuration into share-config-custom.xml and then modify it to suit our needs. The code listing below shows this:</p>
<pre><code>&lt;!-- sc:whitepaper type (new nodes) --&gt;
&lt;config evaluator=&quot;model-type&quot; condition=&quot;sc:whitepaper&quot;&gt;
    &lt;forms&gt;
        &lt;!-- Search form --&gt;
        &lt;form id=&quot;search&quot;&gt;
            &lt;field-visibility&gt;
                &lt;show id=&quot;cm:name&quot; /&gt;
                &lt;show id=&quot;cm:title&quot; force=&quot;true&quot; /&gt;
                &lt;show id=&quot;cm:description&quot; force=&quot;true&quot; /&gt;
                &lt;show id=&quot;mimetype&quot; /&gt;
                &lt;show id=&quot;cm:modified&quot; /&gt;
                &lt;show id=&quot;cm:modifier&quot; /&gt;
                &lt;!-- sc:productRelated --&gt;
                &lt;show id=&quot;sc:product&quot; /&gt;
                &lt;show id=&quot;sc:version&quot; /&gt;
                &lt;!-- sc:webable --&gt;
                &lt;show id=&quot;sc:isActive&quot; /&gt;
                &lt;show id=&quot;sc:published&quot; /&gt;
            &lt;/field-visibility&gt;
            &lt;appearance&gt;
                &lt;field id=&quot;mimetype&quot;&gt;
                    &lt;control template=&quot;/org/alfresco/components/form/controls/mimetype.ftl&quot; /&gt;
                &lt;/field&gt;
                &lt;field id=&quot;cm:modifier&quot;&gt;
                    &lt;control&gt;
                        &lt;control-param name=&quot;forceEditable&quot;&gt;true&lt;/control-param&gt;
                    &lt;/control&gt;
                &lt;/field&gt;
                &lt;field id=&quot;cm:modified&quot;&gt;
                    &lt;control template=&quot;/org/alfresco/components/form/controls/daterange.ftl&quot; /&gt;
                &lt;/field&gt;
                &lt;!-- sc:productRelated --&gt;
                &lt;field id=&quot;sc:product&quot; label-id=&quot;prop.sc_product&quot;&gt;
                    &lt;control template=&quot;/org/alfresco/components/form/controls/textfield.ftl&quot; /&gt;
                &lt;/field&gt;
                &lt;field id=&quot;sc:version&quot; label-id=&quot;prop.sc_version&quot;&gt;
                    &lt;control template=&quot;/org/alfresco/components/form/controls/textfield.ftl&quot; /&gt;
                &lt;/field&gt;               
                &lt;!-- sc:webable --&gt;
                &lt;field id=&quot;sc:isActive&quot; label-id=&quot;prop.sc_isActive&quot;&gt;
                    &lt;control template=&quot;/org/alfresco/components/form/controls/checkbox.ftl&quot; /&gt;
                &lt;/field&gt;
                &lt;field id=&quot;sc:published&quot; label-id=&quot;prop.sc_published&quot;&gt;
                    &lt;control template=&quot;/org/alfresco/components/form/controls/daterange.ftl&quot; /&gt;
                &lt;/field&gt;
            &lt;/appearance&gt;
        &lt;/form&gt;
    &lt;/forms&gt;
&lt;/config&gt;</code></pre>
<p>It is important to note that the field elements in the appearance section require the form control to be specified. If it is not specified, the field will not show up on the search form.</p>
<p>After deploying this configuration and restarting the embedded Tomcat for your Alfresco Share project, the SomeCo Whitepaper type is included in the advanced search dropdown, and four fields for the aspect properties are shown in the search form.</p>
<div class="figure">
<img src="./images/adv-search-type.png" alt="Search by Type" /><p class="caption">Search by Type</p>
</div>
<div class="figure">
<img src="./images/adv-search-props.png" alt="Search custom properties" /><p class="caption">Search custom properties</p>
</div>
<h2 id="localizing-strings-for-custom-content-models">Localizing Strings for Custom Content Models</h2>
<p>We’ve put off localizing the form labels until now. To fix this, first create a messages bundle, then register it with a Spring bean. Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>Create a new folder called &quot;messages&quot; in $TUTORIAL_HOME/content-tutorial-share/src/main/amp/config/alfresco/module/content-tutorial-share.</li>
<li><p>In the messages folder, create a new file called &quot;scModel.properties&quot; with the following content:</p>
<pre><code>#sc:doc
type.sc_doc=SomeCo Doc
assoc.sc_relatedDocuments=Related Documents

#sc:whitepaper
type.sc_whitepaper=SomeCo Whitepaper
search.form.desc.sc_whitepaper=Search for SomeCo Whitepapers

#sc:webable
aspect.sc_webable=SomeCo Webable
prop.sc_published=Published
prop.sc_isActive=Active?

#sc:productRelated
aspect.sc_productRelated=SomeCo Product Related
prop.sc_product=Product
prop.sc_version=Version</code></pre></li>
<li>We need to register this properties bundle with Spring. Share does not look in module directories for Spring context files. Instead, it uses the web-extension folder. Create a new folder called &quot;web-extension&quot; in $TUTORIAL_HOME/content-tutorial-share/src/main/amp/config/alfresco.</li>
<li>In the web-extension folder, create a new file called &quot;content-tutorial-share-context.xml&quot;. I am using the <code>artifactId</code> as part of the file name because this file will ultimately end up in a folder that may contain other Spring configuration files and I don't want this one to collide with any of those.</li>
<li><p>Add the following content to the file, then save:</p>
<pre><code>&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;&lt;!DOCTYPE beans PUBLIC &#39;-//SPRING//DTD BEAN//EN&#39; &#39;http://www.springframework.org/dtd/spring-beans.dtd&#39;&gt;

&lt;beans&gt;
    &lt;!-- Add Someco messages --&gt;
    &lt;bean id=&quot;${project.artifactId}_resources&quot; class=&quot;org.springframework.extensions.surf.util.ResourceBundleBootstrapComponent&quot;&gt;
        &lt;property name=&quot;resourceBundles&quot;&gt;
            &lt;list&gt;
                &lt;value&gt;alfresco.module.${project.artifactId}.messages.scModel&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre></li>
</ol>
<p>Now restart the embedded Tomcat for your Alfresco Share project and you should see that the types, aspects, and properties have the localized labels.</p>
<h2 id="share-configuration-summary">Share Configuration Summary</h2>
<p>You’ve seen that configuring Alfresco Share for your custom content model essentially involves adding XML to the share-config-custom.xml file and creating a properties file for your localized strings. All of this lives in a project created by the Alfresco Maven SDK and is packaged and deployed as an AMP.</p>
<p>There are other things you might like to do to the Share user interface, but these are beyond the scope of this document:</p>
<ul>
<li>Add custom content types to the Create menu</li>
<li>Add custom properties to the document library sort criteria</li>
<li>Add custom properties to the document library data grid</li>
</ul>
<p>Now let’s turn our attention from the front-end to the back-end to understand how to create, query, update, and delete content using code running remotely from the Alfresco server.</p>
<h1 id="part-3-working-with-content-programmatically">Part 3: Working with Content Programmatically</h1>
<p>So far we've created a custom model and we've configured Alfresco Share to let end users work with the types, aspects, and properties defined in the custom model. For simple document management solutions, this may be enough. Often, code will also required. It could be code in a web application that needs to work with the repository, code that implements custom behavior for custom content types, or code that implements Alfresco web client customizations.</p>
<p>There are several API's available depending on what you want to do. The table below outlines the choices:</p>
<table>
<caption>Alfresco API Options</caption>
<thead>
<tr class="header">
<th align="left">Solution type</th>
<th align="left">Language</th>
<th align="left">Alfresco API</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alfresco Share user interface customizations</td>
<td align="left">Freemarker Templating Language, Java/JSP, JavaScript</td>
<td align="left">Alfresco Freemarker API, Alfresco JavaScript API</td>
</tr>
<tr class="even">
<td align="left">Custom applications with an embedded Alfresco repository (Repository runs in the same process as the application)</td>
<td align="left">Java</td>
<td align="left">Alfresco Foundation API</td>
</tr>
<tr class="odd">
<td align="left">Custom applications using a remote Alfresco repository</td>
<td align="left">Java, Python, PHP, .NET, or any language that can make calls via HTTP</td>
<td align="left">CMIS, Web Scripts</td>
</tr>
</tbody>
</table>
<p>The best way to make remote calls to the Alfresco repository is to leverage Alfresco’s support for the Content Management Interoperability Services (CMIS) <a href="https://www.oasis-open.org/committees/cmis">standard</a>. So let’s look at CMIS examples for creating, updating, querying, and deleting content. The client API’s available from the <a href="http://chemistry.apache.org">Apache Chemistry</a> project offer a variety of languages to choose from. This tutorial focuses on Java.</p>
<p>If you need to learn how to make these other styles of customizations, consult <a href="http://ecmarchitect.com">ecmarchitect.com</a> and the <a href="http://docs.alfresco.com">Alfresco Documentation</a>.</p>
<h2 id="setup">Setup</h2>
<p>Let's run through some examples that leverage OpenCMIS to work with instances of the custom types defined in the model. To facilitate this, I'm going to create two new Maven projects, but because they don't produce AMPs there is no reason to use the Alfresco Maven SDK to create them.</p>
<p>To create the projects we need for this part, do this:</p>
<ol style="list-style-type: decimal">
<li>Create a new project called &quot;content-tutorial-common&quot;.</li>
<li>Create a source directory called &quot;java&quot; in &quot;src/main&quot;.</li>
<li>If you are using Eclipse, convert the project to a Maven project using Configure, Convert to Maven Project. This will create a default pom.xml in the root of your project folder. I am using &quot;com.someco&quot; for the <code>groupId</code> and &quot;content-tutorial-common&quot; for the <code>artifactId</code>.</li>
<li>Repeat the steps above for a new project called &quot;content-tutorial-cmis&quot;.</li>
<li>Edit the pom.xml file that belongs to &quot;content-tutorial-cmis&quot;.</li>
<li><p>This project uses the OpenCMIS library from Apache Chemistry, the Alfresco OpenCMIS Extension Library, and the content-tutorial-common project, so add those as dependencies:</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.chemistry.opencmis&lt;/groupId&gt;
    &lt;artifactId&gt;chemistry-opencmis-client-impl&lt;/artifactId&gt;
    &lt;version&gt;0.11.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.alfresco.cmis.client&lt;/groupId&gt;
    &lt;artifactId&gt;alfresco-opencmis-extension&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.someco&lt;/groupId&gt;
    &lt;artifactId&gt;content-tutorial-common&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre></li>
<li><p>The alfresco-opencmis-extension artifact resides in the Alfresco artifacts repository, so add that repository to your pom.xml:</p>
<pre><code>&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;artifacts.alfresco.com&lt;/id&gt;
        &lt;name&gt;Alfresco Maven Repository&lt;/name&gt;
        &lt;url&gt;https://artifacts.alfresco.com/nexus/content/groups/public/&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;</code></pre></li>
<li><p>The content-tutorial-common project will contain code common the CMIS project will use as well as projects in later tutorials. For this tutorial, all we need is the com.someco.model.SomeCoModel.java class which contains constants that map to the custom content model. These constants are used for convenience by Java classes that need to know things like namespaces, names of content types, etc. If you are building your own project just copy it from the source.</p></li>
</ol>
<p>To run the examples in Part 3 you need to have an Alfresco repository running with the repo tier AMP you created in Part 1. Using the embedded Tomcat server as shown in that part of the tutorial works fine.</p>
<p>Now you are ready to write some code.</p>
<h2 id="creating-content-with-opencmis">Creating Content with OpenCMIS</h2>
<p>The code we're going to use for creating content is almost exactly the same code that comes with the old non-CMIS Alfresco SDK Samples.</p>
<p>The goal here is to create a runnable class called <code>SomeCoCMISDataCreator</code> that accepts arguments for the username, password, folder in which to create the content, type of content we're creating, and a name for the new content. I've left out the main method as well as the code that establishes the session, but you can see the full class <a href="https://github.com/jpotts/alfresco-developer-series/blob/master/content/content-tutorial-cmis/src/main/java/com/someco/cmis/examples/SomeCoCMISDataCreator.java">here</a>.</p>
<p>The first thing the code does is grab a session. The <code>getSession()</code> method is inherited from a class called <a href="https://github.com/jpotts/alfresco-developer-series/blob/master/content/content-tutorial-cmis/src/main/java/com/someco/cmis/examples/CMISExampleBase.java">CMISExampleBase</a> which is used for all of the CMIS examples in this document. The important thing to know about that method is that it uses the value of <code>serviceUrl</code> to know how to connect to your Alfresco server. The URL currently specified is the one to use when connecting to a 5.x server running on localhost using the AtomPub binding. The URL is:</p>
<pre><code>http://localhost:8080/alfresco/api/-default-/public/cmis/versions/1.0/atom</code></pre>
<p>A common mistake is to use an old CMIS service URL, so make sure you are using the correct one according to the version of Alfresco you are using.</p>
<p>Once the code has a session, it gets a reference to the folder where the content will be created. The timestamp is incorporated into the content name so that if the code is run multiple times, the object names will be unique.</p>
<pre><code>Session session = getSession();

// Grab a reference to the folder where we want to create content
Folder folder = (Folder) session.getObjectByPath(&quot;/&quot; + getFolderName());

String timeStamp = new Long(System.currentTimeMillis()).toString();
String filename = getContentName() + &quot; (&quot; + timeStamp + &quot;)&quot;;</code></pre>
<p>Next, the code sets up the properties that will be set on the new document. It creates a <code>Map</code> of <code>Strings</code> and <code>Objects</code> to hold the property names and values.</p>
<pre><code>// Create a Map of objects with the props we want to set
Map &lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();
// Following sets the content type and adds the webable and productRelated aspects
// This works because we are using the OpenCMIS extension for Alfresco
properties.put(PropertyIds.OBJECT_TYPE_ID,
               &quot;D:sc:whitepaper,P:sc:webable,P:sc:productRelated&quot;);
properties.put(PropertyIds.NAME, filename);
properties.put(&quot;sc:isActive&quot;, true);
GregorianCalendar publishDate = new GregorianCalendar(2007,4,1,5,0);
properties.put(&quot;sc:published&quot;, publishDate);</code></pre>
<p>Notice that instead of listing a single value for the object type ID, a comma-separated list is being passed in. This is the content type followed by the aspects that need to be added. This is possible because the code leverages an Alfresco-specific extension that allows us to work with aspects. It is also important to point out that, in CMIS, document types begin with “D:” while policy types begin with “P:”. (CMIS 1.0 doesn’t have a native concept of aspects—what Alfresco calls an aspect, CMIS 1.0 calls a “Policy”-just go with it).</p>
<p>Starting with version 4.2, Alfresco began to support CMIS 1.1. That version of the specification calls aspects &quot;secondary types&quot;. Using CMIS 1.1 you no longer need to use the Alfresco OpenCMIS extension to work with aspects. If you want to see how to add aspects using CMIS 1.1, see <a href="https://gist.github.com/jpotts/7242070">this gist</a>.</p>
<p>The next step is to prepare the content that will be set on the new object. This is a matter of calling the <code>createContentStream()</code> method on the <code>ObjectFactory</code> with the file name, length, mimetype, and an <code>InputStream</code> based on the content.</p>
<pre><code>String docText = &quot;This is a sample &quot; + getContentType() + &quot; document called &quot; +
       getContentName();
byte[] content = docText.getBytes();
InputStream stream = new ByteArrayInputStream(content);
ContentStream contentStream = session.getObjectFactory().
    createContentStream(
        filename, Long.valueOf(content.length), &quot;text/plain&quot;, stream
    );</code></pre>
<p>Finally, the code tells the folder to create a new document and passes in the properties, content stream, and versioning state, then dumps the length of the content that was created.</p>
<pre><code>Document doc = folder.createDocument(properties, contentStream,
     VersioningState.MAJOR);
System.out.println(&quot;Content Length: &quot; + doc.getContentStreamLength());</code></pre>
<p>If you are in an IDE like Eclipse, you should be able to set the arguments and run this class easily. If you want to do it from the command line, you can run it via Maven so that it will set up the classpath for you. To do that you would run:</p>
<pre><code>mvn exec:java \
-Dexec.mainClass=&quot;com.someco.cmis.examples.SomeCoCMISDataCreator&quot; \
-Dexec.args=&quot;admin admin SomeCo whitepaper test&quot;</code></pre>
<p>Running <code>SomeCoCMISDataCreator.class</code> produces:</p>
<pre><code>Created: dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
Content Length: 59</code></pre>
<p>If you are following along, you might want to run it a few times to have some test content to play with.</p>
<h2 id="creating-associations-with-opencmis">Creating Associations with OpenCMIS</h2>
<p>Now let's look at a class that creates a “related documents” association between two documents.</p>
<p>The <a href="https://github.com/jpotts/alfresco-developer-series/blob/master/content/content-tutorial-cmis/src/main/java/com/someco/cmis/examples/SomeCoCMISDataRelater.java">SomeCoCMISDataRelater</a> class accepts a source object ID and a target object ID as arguments. The code creates a map of properties containing the association type, source ID, and target ID. Note that the association type is preceded by “R:” when working with CMIS.</p>
<pre><code>Session session = getSession();

// Create a Map of objects with the props we want to set
Map &lt;String, String&gt; properties = new HashMap&lt;String, String&gt;();
properties.put(PropertyIds.OBJECT_TYPE_ID, &quot;R:sc:relatedDocuments&quot;);
properties.put(PropertyIds.SOURCE_ID, getSourceObjectId());
properties.put(PropertyIds.TARGET_ID, getTargetObjectId());
try {
    session.createRelationship(properties);
} catch (Exception e) {
    System.out.println(&quot;Oops, something unexpected happened. Maybe the rel already exists?&quot;);
}</code></pre>
<p>The last half of the method dumps the associations of the source object. The trick here is that when you make the <code>getObject()</code> call to instantiate the object, you will not get back the relationships by default. The <code>OperationContext</code> that is being instantiated makes sure that happens.</p>
<pre><code>// Dump the object&#39;s associations
OperationContext oc = new OperationContextImpl();
oc.setIncludeRelationships(IncludeRelationships.SOURCE);
Document sourceDoc = (Document) session.getObject(
              session.createObjectId(getSourceObjectId()),
              oc);
List&lt;Relationship&gt; relList = sourceDoc.getRelationships();
System.out.println(&quot;Associations of objectId:&quot; + getSourceObjectId());
for (Relationship rel : relList) {
    System.out.println(&quot;    &quot; + rel.getTarget().getId());
}</code></pre>
<p>The last line calls a method that queries the associations for a given reference. This should dump the association that was just created plus any other associations that have been created for this object.</p>
<p>If you want to run this on your own using Maven, it would look something like this, with your own values for the source and target object ID’s:</p>
<pre><code>mvn exec:java \
-Dexec.mainClass=&quot;com.someco.cmis.examples.SomeCoCMISDataRelater&quot;
-Dexec.args=&quot;admin admin SomeCo whitepaper test dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0 bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0&quot;</code></pre>
<p>Running the Java snippet as above, assuming no other relationships exist on the source object produces:</p>
<pre><code>Associations of objectId: dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
    bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0</code></pre>
<p>Now you can use the Alfresco Share client to view the associations as shown below:</p>
<div class="figure">
<img src="./images/cmis-assocs.png" alt="CMIS created the related documents association shown here" /><p class="caption">CMIS created the related documents association shown here</p>
</div>
<p>Remember the share-config-custom.xml file? It says that any time the default form or edit metadata form is used for <code>sc:whitepaper</code> objects, the <code>sc:relatedDocuments</code> associations should be shown. Alternatively, the Node Browser, available in the Alfresco Share Administration Console, is a handy way to view associations.</p>
<h2 id="searching-for-content-with-opencmis">Searching for Content with OpenCMIS</h2>
<p>Now that there are some instances of SomeCo’s custom types in the repository it is time to write code that will query for those. Starting with Alfresco 4.0, there are two options for search. The first option is to use Lucene, which is the embedded search engine that has always shipped with Alfresco. The second option is to use Solr. If you upgraded an existing pre-4.0 installation and made no other changes, you are using Lucene. If you installed 4.0 using the installer, you are using Solr. You can switch from one to the other—refer to the documentation to find out how.</p>
<p>Regardless of the search engine option you’ve chosen, content in the repository is automatically indexed by Alfresco. You can execute searches to find content based on full-text, property values, content types, and folder paths.</p>
<p>There are a number of supported search dialects. Prior to 3.4, the most common dialect was Lucene. Starting with 3.4, Alfresco introduced a new dialect called Alfresco FTS which is an abstraction that means you don’t have to learn the specific Lucene search syntax. XPath is also an option, although it’s not used that often. CMIS has its own query language which looks a lot like SQL.</p>
<p>If you are writing code against an Alfresco repository that is 3.4 or higher, you should use either Alfresco FTS or CMIS Query Language, if possible. This part of the tutorial is focused on CMIS, so let's write some CMIS Query Language queries.</p>
<p>Just like the content creation code, the <a href="https://github.com/jpotts/alfresco-developer-series/blob/master/content/content-tutorial-cmis/src/main/java/com/someco/cmis/examples/SomeCoCMISDataQueries.java">SomeCoCMISDataQueries</a> class will be a runnable Java application that accepts the username, password, and folder name as arguments. It includes a generic method used to execute a query which is called repeatedly with multiple query examples.</p>
<p>If you are following along, you should either run the content creation code a few times or create some content manually so you can test out the queries more thoroughly.</p>
<p>Let's take a look at the generic query execution method first, then the method that calls it for each example query string.</p>
<p>The <code>getQueryResults()</code> method is pretty straightforward. It returns a list of <code>CmisObject</code> objects. It instantiates those objects by iterating over the query results, grabbing the <code>objectId</code> from each result, and making a <code>getObject()</code> call on the <code>session</code>.</p>
<pre><code>public List&lt;CmisObject&gt; getQueryResults(String queryString) {
    List&lt;CmisObject&gt; objList = new ArrayList&lt;CmisObject&gt;();
    Session session = getSession();

    // execute query
    ItemIterable&lt;QueryResult&gt; results = session.query(queryString, false);

    for (QueryResult qResult : results) {
        PropertyData&lt;?&gt; propData = qResult.getPropertyById(&quot;cmis:objectId&quot;);
        String objectId = (String) propData.getFirstValue();
        CmisObject obj = session.getObject(session.createObjectId(objectId));
        objList.add(obj);
    }

    return objList;
};</code></pre>
<p>The <code>doExamples()</code> method then executes a series of example queries and dumps the results. The first two queries are simple. One returns every instance of <code>sc:doc</code> including instances of types that inherit from <code>sc:doc</code>. The second one finds any objects residing in the folder passed in that contain the word “sample” anywhere in the content. Notice the SQL-like syntax of CMIS Query Language. It basically treats content types as if they were tables.</p>
<pre><code>System.out.println(RESULT_SEP);
System.out.println(&quot;Finding content of type:&quot; +
     SomeCoModel.TYPE_SC_DOC.toString());
queryString = &quot;select * from sc:doc&quot;;
dumpQueryResults(getQueryResults(queryString));

System.out.println(RESULT_SEP);
System.out.println(&quot;Find content in the root folder with text like &#39;sample&#39;&quot;);
queryString = &quot;select * from cmis:document where contains(&#39;sample&#39;) and
     in_folder(&#39;&quot; + getFolderId() + &quot;&#39;)&quot;;
dumpQueryResults(getQueryResults(queryString));</code></pre>
<p>You might have noticed the <code>getFolderId()</code> call. The <code>in_folder</code> predicate expects an object ID. So the <code>getFolderId()</code> method does a query to find the object ID of the folder that was passed in as an argument to the class. It would be nice if you could do this in a single query, but you can’t.</p>
<h3 id="queries-on-aspect-based-properties">Queries on Aspect-based Properties</h3>
<p>The next query looks for active content. This is when it starts to get interesting because the property that tracks whether or not a piece of content is active, <code>sc:isActive</code>, is defined on an aspect. The CMIS specification allows for joins in queries. But Alfresco does not support joins except in the special case of aspects. In Alfresco CMIS, joins are used to relate a base type to one of its aspects. That allows you to use an aspect-based property in a where clause.</p>
<pre><code>System.out.println(RESULT_SEP);
System.out.println(&quot;Find active content&quot;);
queryString = &quot;select d.*, w.* from cmis:document as d join sc:webable as w on
     d.cmis:objectId = w.cmis:objectId where w.sc:isActive = True&quot;;
dumpQueryResults(getQueryResults(queryString));</code></pre>
<h3 id="queries-across-multiple-aspects">Queries Across Multiple Aspects</h3>
<p>The next query shows another special case. In this example the goal is to find the active content that has a product property set to a specific value. That’s a challenge because the <code>sc:isActive</code> property is defined by the <code>sc:webable</code> aspect while the <code>sc:product</code> property is defined by a different aspect, <code>sc:productRelated</code>. Unfortunately, there is no good way to get these results in a single query. The solution used here is to write a method called <code>getSubQueryResults()</code> that accepts two queries as arguments. The method runs the first query and then builds an <code>IN</code> predicate using the object IDs that come back, which it appends to the second query before invoking it.</p>
<pre><code>System.out.println(RESULT_SEP);
System.out.println(&quot;Find active content with a product equal to &#39;SomePortal&#39;&quot;);
String queryString1 = &quot;select d.cmis:objectId from cmis:document as d join
    sc:productRelated as p on d.cmis:objectId = p.cmis:objectId &quot; +
    &quot;where p.sc:product = &#39;SomePortal&#39;&quot;;
String queryString2 = &quot;select d.cmis:objectId from cmis:document as d join
    sc:webable as w on d.cmis:objectId = w.cmis:objectId &quot; +
     &quot;where w.sc:isActive = True&quot;;
dumpQueryResults(getSubQueryResults(queryString1, queryString2));</code></pre>
<h3 id="queries-using-dates">Queries Using Dates</h3>
<p>The last query uses the aspect join trick to do a date range search on instances of <code>sc:whitepaper</code> published between a specific range.</p>
<pre><code>System.out.println(RESULT_SEP);
System.out.println(&quot;Find content of type sc:whitepaper published between 1/1/2006
    and 6/1/2007&quot;);
queryString = &quot;select d.cmis:objectId, w.sc:published from sc:whitepaper as d join
    sc:webable as w on d.cmis:objectId = w.cmis:objectId &quot; +  
    &quot;where w.sc:published &gt; TIMESTAMP &#39;2006-01-01T00:00:00.000-05:00&#39; &quot; +
    &quot;  and w.sc:published &lt; TIMESTAMP &#39;2007-06-02T00:00:00.000-05:00&#39;&quot;;
dumpQueryResults(getQueryResults(queryString));</code></pre>
<h3 id="running-the-queries">Running the Queries</h3>
<p>If you want to compile and run this on your own machine, you can use one of the Ant tasks in the build.xml file included in the code that accompanies this article. Just type:</p>
<pre><code>mvn exec:java \
-Dexec.mainClass=&quot;com.someco.cmis.examples.SomeCoCMISDataQueries&quot; \
-Dexec.args=&quot;admin admin SomeCo&quot;</code></pre>
<p>Your results will vary based on how much content you've created and the values you've set in the content properties, but when I ran my test, the results were as shown below.</p>
<pre><code>======================
Finding content of type:doc
----------------------
Result 1:
id:c7c1a94e-8d9c-4434-89b0-cbe14ef94455;1.0
name:test1.txt
created:Jan 22, 2014 2:22:00 PM
----------------------
Result 2:
id:40ec2412-b1e6-4d86-af8b-4003adeeed46;1.0
name:test (1390506931762)
created:Jan 23, 2014 1:55:31 PM
----------------------
Result 3:
id:c3e61b61-e5d4-4edf-a3e9-0eac61c693e8;1.0
name:test (1390507967128)
created:Jan 23, 2014 2:12:47 PM
----------------------
Result 4:
id:bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0
name:test (1390508346539)
created:Jan 23, 2014 2:19:06 PM
----------------------
Result 5:
id:dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
name:test (1390508353662)
created:Jan 23, 2014 2:19:13 PM
======================
Find content in the root folder with text like &#39;sample&#39;
----------------------
Result 1:
id:40ec2412-b1e6-4d86-af8b-4003adeeed46;1.0
name:test (1390506931762)
created:Jan 23, 2014 1:55:31 PM
----------------------
Result 2:
id:c3e61b61-e5d4-4edf-a3e9-0eac61c693e8;1.0
name:test (1390507967128)
created:Jan 23, 2014 2:12:47 PM
----------------------
Result 3:
id:bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0
name:test (1390508346539)
created:Jan 23, 2014 2:19:06 PM
----------------------
Result 4:
id:dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
name:test (1390508353662)
created:Jan 23, 2014 2:19:13 PM
----------------------
Result 5:
id:4c9b0bda-ca90-4ad8-bf01-28ca6f9072bc;1.0
name:test (1390508793841)
created:Jan 23, 2014 2:26:33 PM
======================
Find active content
----------------------
Result 1:
id:40ec2412-b1e6-4d86-af8b-4003adeeed46;1.0
name:test (1390506931762)
created:Jan 23, 2014 1:55:31 PM
----------------------
Result 2:
id:c3e61b61-e5d4-4edf-a3e9-0eac61c693e8;1.0
name:test (1390507967128)
created:Jan 23, 2014 2:12:47 PM
----------------------
Result 3:
id:bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0
name:test (1390508346539)
created:Jan 23, 2014 2:19:06 PM
----------------------
Result 4:
id:dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
name:test (1390508353662)
created:Jan 23, 2014 2:19:13 PM
----------------------
Result 5:
id:6d7de742-8604-4e50-8770-931ff81f9aa2;1.0
name:dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0 (1390508459588)
created:Jan 23, 2014 2:20:59 PM
======================
Find active content with a product equal to &#39;SomePortal&#39;
----------------------
Result 1:
id:648660bb-2a0f-4ffc-9200-1aded09255c0;1.0
name:test (1390508759315)
created:Jan 23, 2014 2:25:59 PM
======================
Find content of type sc:whitepaper published between 1/1/2006 and 6/1/2007
----------------------
Result 1:
id:40ec2412-b1e6-4d86-af8b-4003adeeed46;1.0
name:test (1390506931762)
created:Jan 23, 2014 1:55:31 PM
----------------------
Result 2:
id:c3e61b61-e5d4-4edf-a3e9-0eac61c693e8;1.0
name:test (1390507967128)
created:Jan 23, 2014 2:12:47 PM
----------------------
Result 3:
id:bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0
name:test (1390508346539)
created:Jan 23, 2014 2:19:06 PM
----------------------
Result 4:
id:dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
name:test (1390508353662)
created:Jan 23, 2014 2:19:13 PM
----------------------
Result 5:
id:6d7de742-8604-4e50-8770-931ff81f9aa2;1.0
name:dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0 (1390508459588)
created:Jan 23, 2014 2:20:59 PM</code></pre>
<h2 id="deleting-content-with-opencmis">Deleting Content with OpenCMIS</h2>
<p>Now it is time to clean up after ourselves by deleting content from the repository. The delete logic in the <a href="https://github.com/jpotts/alfresco-developer-series/blob/master/content/content-tutorial-cmis/src/main/java/com/someco/cmis/examples/SomeCoCMISDataCleaner.java">SomeCoCMISDataCleaner</a> class is similar to the search logic except that instead of dumping the results, the CmisObject’s <code>delete()</code> method gets called on every hit that is returned.</p>
<pre><code>Session session = getSession();

// execute query
String queryString = &quot;select * from sc:doc&quot;;
ItemIterable&lt;QueryResult&gt; results = session.query(queryString, false);

// if we found some rows, create an array of DeleteCML objects      
if (results.getTotalNumItems() &gt;= 0)
    System.out.println(&quot;Found &quot; + results.getTotalNumItems() + &quot; objects to delete.&quot;);

for (QueryResult qResult : results) {
    PropertyData&lt;?&gt; propData = qResult.getPropertyById(&quot;cmis:objectId&quot;);
    String objectId = (String) propData.getFirstValue();
    CmisObject obj = session.getObject(session.createObjectId(objectId));
    obj.delete(true);
    System.out.println(&quot;Deleted: &quot; + objectId);
}
System.out.println(&quot;Done!&quot;);</code></pre>
<p>Note that this code deletes every object in the repository of type <code>sc:doc</code> and instances of child types. You would definitely want to “think twice and cut once” if you were running this code on a production repository, particularly if you were using a broad content type like <code>cm:content</code>.</p>
<p>Similar to the other examples, you can compile and run this on the command line by executing the following:</p>
<pre><code>mvn exec:java \
-Dexec.mainClass=&quot;com.someco.cmis.examples.SomeCoCMISDataCleaner&quot; \
-Dexec.args=&quot;admin admin SomeCo&quot;</code></pre>
<p>Again, your results will vary based on the content you've created but in my repository, running the code results in the following:</p>
<pre><code>Found 8 objects to delete.
Deleted: 40ec2412-b1e6-4d86-af8b-4003adeeed46;1.0
Deleted: c3e61b61-e5d4-4edf-a3e9-0eac61c693e8;1.0
Deleted: bfd4b553-ff58-4d6e-a71b-00a470bd86c9;1.0
Deleted: dbe2a709-5fd8-453e-9f9d-dff1e4c785d3;1.0
Deleted: 6d7de742-8604-4e50-8770-931ff81f9aa2;1.0
Deleted: 12e6f012-1831-4d2a-81f8-d130cd26e968;1.0
Deleted: 4c9b0bda-ca90-4ad8-bf01-28ca6f9072bc;1.0
Deleted: 648660bb-2a0f-4ffc-9200-1aded09255c0;1.0
Done!</code></pre>
<p>Now you know how to use CMIS, an industry-standard API, to create, relate, query, and delete objects in Alfresco. In fact, the code you've worked with here in Part 3 should work with any CMIS-compliant server (except for the aspect bits).</p>
<h1 id="other-topics-to-explore-on-your-own">Other Topics to Explore on Your Own</h1>
<p>This tutorial has shown how to extend Alfresco's out-of-the-box content model with your own business-specific content types, how to expose those types, aspects, and properties in Alfresco Share, and how to work with content via OpenCMIS, the Java API for CMIS that is part of Apache Chemistry. I've thrown in a few recommendations that will hopefully save you some time or at least spark some discussion.</p>
<p>There are many content model-related topics we didn't talk about that you can explore on your own, like:</p>
<ul>
<li>Controlling how your properties are indexed</li>
<li>Using queries or services to populate constraints</li>
<li>Creating custom form controls</li>
<li>Hot-deploying content models</li>
<li>Using a content modeling tool to create content models and forms through a user interface rather than XML</li>
</ul>
<h1 id="where-to-find-more-information">Where to Find More Information</h1>
<ul>
<li>The complete source code for these examples is available on <a href="https://github.com/jpotts/alfresco-developer-series">GitHub</a>.</li>
<li>Official documentation for both Enterprise Edition and Community Edition is available at <a href="http://docs.alfresco.com/">docs.alfresco.com</a>.</li>
<li><a href="http://share-extras.github.io/">Share Extras</a> has many examples of deeper Share customization.</li>
<li>The <a href="http://wiki.alfresco.com/wiki/Category:Search">Search-related pages</a> on the Alfresco wiki provide query examples using both Lucene and XPath.</li>
<li>The <a href="http://chemistry.apache.org/">Apache Chemistry Home Page</a> has examples and source code that works with CMIS.</li>
<li>See <a href="http://ecmarchitect.com/archives/2009/11/23/1094">“Getting Started with CMIS”</a> on <a href="http://ecmarchitect.com">ecmarchitect.com</a> for a brief introduction to CMIS. The <a href="http://cmis.alfresco.com/">Alfresco CMIS</a> page is also a great resource. And there is now a <a href="http://www.manning.com/mueller/">CMIS book</a> availaible.</li>
<li>For deployment help, see <a href="http://wiki.alfresco.com/wiki/Packaging_And_Deploying_Extensions">Packaging and Deploying Extensions</a> in the Alfresco wiki.</li>
<li>For general development help, see the <a href="http://wiki.alfresco.com/wiki/Developer_Guide">Developer Guide</a>.</li>
<li>For help customizing the data dictionary, see the <a href="http://wiki.alfresco.com/wiki/Data_Dictionary_Guide">Data Dictionary</a> wiki page.</li>
<li>If you are ready to cover new ground, try another <a href="http://ecmarchitect.com">ecmarchitect.com</a> tutorial in the <a href="http://ecmarchitect.com/alfresco-developer-series">Alfresco Developer Series</a>.</li>
</ul>
					</div><!-- .entry-content -->
				</div><!-- #post-## -->
			</div><!-- #content -->
		</div><!-- #container -->
	</div><!-- #main -->
	<div id="footer" role="contentinfo">
		<div id="colophon">
			<div id="site-info">
				<p><a href="http://ecmarchitect.com/"
		title="ECM Architect" rel="home">ECM
		Architect</a></p>
			  
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.			  
			</div><!-- #site-info -->
		</div><!-- #colophon -->
	</div><!-- #footer -->
<div class="github-fork-ribbon-wrapper right-bottom">
        <div class="github-fork-ribbon">
            <a href="https://github.com/jpotts/alfresco-developer-series">Fork me on GitHub</a>
        </div>
    </div>
</div><!-- header -->
</body>
</html>
